<?php
namespace W2w\Laravel\Apie\Controllers;

use Illuminate\Contracts\Routing\UrlGenerator as LaravelUrlGenerator;
use Laravel\Lumen\Routing\UrlGenerator as LumenUrlGenerator;
use Zend\Diactoros\Response\TextResponse;

/**
 * Renders swagger UI for the openAPI spec generated by Apie.
 */
class SwaggerUiController
{
    private $urlGenerator;

    private $htmlLocation;

    /**
     * @param LaravelUrlGenerator|LumenUrlGenerator $urlGenerator
     * @param string $htmlLocation
     */
    public function __construct($urlGenerator, string $htmlLocation)
    {
        $this->urlGenerator = $urlGenerator;
        $this->htmlLocation = $htmlLocation;
    }

    public function __invoke()
    {
        return new TextResponse(
            str_replace('{{ url }}', $this->urlGenerator->route('apie.docs'), file_get_contents($this->htmlLocation)),
            200,
            [
                'content-type' => 'text/html'
            ]
        );
    }
}
